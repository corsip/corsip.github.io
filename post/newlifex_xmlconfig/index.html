<!DOCTYPE html>
<html lang="zh-CN">
 <head>
     <meta charset="utf-8" />
  <title>Newlifex修仙（一） 超级配置文件 | 牧轩日志录</title>
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
  <link rel="stylesheet" href="https://www.lucoder.com/styles/main.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
   <script src="https://cdn.staticfile.org/highlight.js/9.15.9/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
 </head>
 <body>
     <div class="sidebar animated fadeInDown">
   <div class="logo-title">
    <div class="title">
     <img src="https://www.lucoder.com/images/avatar.png?v=1569718407158" style="width:127px;" />

     <div class="description">
      <p><p align="center">
Computational Optical and Remote Sensing Image Processing<br />
光学计算与遥感处理
</p></p>
     </div>
    </div>
   </div>
   <ul class="social-links">


    

    

    

    

    

    

    

    

    

    

   </ul>
   <div class="footer">
    <div class="by_farbox">
   <a href="/">牧轩居士</a> | <a href="https://pan.lucoder.com" target="_blank">网盘</a> | <a href="https://mirrors.lucoder.com" target="_blank">镜像</a> | <a href="https://oss.lucoder.com/" target="_blank">图床</a> | <a href="https://gridea.dev/" target="_blank">Gridea</a>
    </div>
    

    </div>
   </div>
  </div>
  <div class="main">
     <div class="page-top animated fadeInDown">
    <div class="nav">
    
     <li><a  href="/">首页</a></li>

     <li><a  href="/archives">归档</a></li>

     <li><a  href="/tags">标签</a></li>

     <li><a  href="https://www.lucoder.com/post/tools/">工具</a></li>

     <li><a  href="https://www.lucoder.com/post/links/">链接</a></li>

     <li><a  href="https://www.lucoder.com/post/about/">关于</a></li>

    </div>
    <div class="information">
     <div class="back_btn">
      <li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li>
     </div>
    </div>
   </div>
   <div class="autopagerize_page_element">
    <div class="content">
     <div class="post-page">
      <div class="post animated fadeInDown">
       <div class="post-title">
        <h3><a>Newlifex修仙（一） 超级配置文件</a></h3>
       </div>
       <div class="post-content">
        <p>新生命团队基础框架X组件，包括日志、数据库、网络、RPC、序列化、缓存、Windows服务、多线程等模块，支持.Net Framework/.netstandard/Mono。</p>
<!-- more -->
<p><img src="https://www.newlifex.com/logo.png" alt=""><br>
说道配置文件，大家觉得太平凡和普通了，有人说有<code>App.Config</code>本来就可以用，何必造轮子玩耍，只能回答你一句，骚年，你太年轻了！🤣🤣🤣🤣🤣🤣 还有很多系统的配置可能需要及时生效（在不需要重新启动的情况下），以及程序中使用的简单，灵活性，也是一个重点。自从用了<code>Newlifex.Core</code>只觉得“六宫粉黛无颜色”，今天就来忽悠一波<code>Newlife.Core</code>中的超级配置文件<code>XmlConfig</code>。</p>
<h1 id="newlifex超级配置优势">Newlifex超级配置优势</h1>
<p>1.开发过程中建立一个配置文件非常方便。集成，加属性，加默认值，如果有其他逻辑，补充一下。<br>
2.使用极其方便，通过XXX类名.Current.属性名 就可以直接对配置项进行读写。<br>
3.修改及时生效，可以设置生效时间，这样很多情况下，程序不用重启配置就能及时生效。<br>
4.程序启动如果发现没有该配置项目，会自动新建默认配置文件。与XCode的反向工程异曲同工。<br>
5.支持列表，字典等复杂数据结构。<br>
6.代码注释和XML文件的注释匹配。</p>
<h1 id="nuget下载">Nuget下载</h1>
<p>首先进入<code>Nuget</code>，在<code>Nuget</code>里面搜索<code>Newlife</code>，选择<code>Newlife.Core</code>安装即可。<br>
<img src="https://oss.lucoder.com/uploads/2019/09/28/20190927231626.png" alt=""></p>
<figure data-type="image" tabindex="1"><img src="https://oss.lucoder.com/uploads/2019/09/28/20190927231822.png" alt=""></figure>
<h1 id="创建模板">创建模板</h1>
<p>在配置组建中，最重要的一个就是需要预先定义一个实体类，可以通过反射机制自动将Xml配置注入到实体类中，下面是一个配置文件，可能对你没有实际意义。</p>
<pre><code class="language-cs">[Description(&quot;Hook配置&quot;)]
[XmlConfigFile(&quot;Config/others/hook.config&quot;, 3000)]
public class GithubSettings : XmlConfig&lt;Settings&gt;
{
    /// &lt;summary&gt;仓库地址&lt;/summary&gt;
    [Description(&quot;仓库地址&quot;)]
    public string Resp { get; set; } = &quot;&quot;;
    /// &lt;summary&gt;克隆分支&lt;/summary&gt;
    [Description(&quot;分支&quot;)]
    public string Branch { get; set; } = &quot;master&quot;;
    /// &lt;summary&gt;克隆位置&lt;/summary&gt;
    [Description(&quot;克隆位置&quot;)]
    public string CloneTo { get; set; } = &quot;&quot;;
}
</code></pre>
<p>僵硬的解释一波，其中<code>XmlConfigFile</code>是配置文件属性注入，第一个参数是保存的配置文件地址，第二个是重新加载间隔（几道为啥可以热更新了吧😂😂😂😂），后面的代码基本没啥说的，只要有C#基础就能看懂了，要说明的是两点：</p>
<ol>
<li>如果配置文件存在程序运行时候自动加载文件，否则会创建一个配置文件，并且将默认值写入文件。</li>
<li>程序内部可以热修改配置，根据设置的时间自动同步数据。</li>
</ol>
<h1 id="运行程序">运行程序</h1>
<p>需要注意的是每一个配置文件都有一个Current的实例，可以通过该实例取出当前的配置信息。</p>
<pre><code class="language-cs">public static void Main(string[] args)
{
    GithubSettings.Current.Resp = &quot;https://github.com/corsip/corsip.github.io&quot;;
    Console.WriteLine(GithubSettings.Current.Resp);
    GithubSettings.Current.Save();
}
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://oss.lucoder.com/uploads/2019/09/28/20190927235904.png" alt=""></figure>
<h1 id="查看文件">查看文件</h1>
<figure data-type="image" tabindex="3"><img src="https://oss.lucoder.com/uploads/2019/09/28/20190927235943.png" alt=""></figure>
<h1 id="广告">广告</h1>
<p>Newlifex 组建还有其他各种🐂🍺的功能需要等待发掘，尤其是网络库、Xcode更是非常棒的开源库，但是笔者暂时用不到这个模块，So....</p>

       </div>
       <div class="post-footer">
        <div class="meta">
         <div class="info">
          <i class="fa fa-sun-o"></i>
          <span class="date">2019-09-27</span>
          <i class="fa fa-tag"></i>
          
          <a class="tag" href="https://www.lucoder.com/tag/p08U871SR" title="NewlifeX">NewlifeX </a>
          
          <a class="tag" href="https://www.lucoder.com/tag/DQkSGhZ_Au" title="XmlConfig">XmlConfig </a>
          
         </div>
        </div>
       </div>
      </div>
      <div class="share">
       <div class="evernote">
        <a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a>
       </div>
       <div class="weibo">
        <a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a>
       </div>
       <div class="twitter">
        <a class="fa fa-twitter" href="http://twitter.com/home?status=,https://www.lucoder.com/post/newlifex_xmlconfig,;"></a>
       </div>
      </div>
      <div class="pagination">
       <ul class="clearfix">

        <li class="pre pagbuttons"><a class="btn" role="navigation" href="https://www.lucoder.com/post/eJMrytUkr" title="GDAL波段分离">上一篇</a></li>
         
        
        <li class="next pagbuttons"><a class="btn" role="navigation" href="https://www.lucoder.com/post/C76sG8kdU" title=" Windows 10 编译Mingw版本OpenCV">下一篇</a></li>
        
       </ul>
      </div>
        
     </div>
    </div>
   </div>
  </div>
  <script src="https://www.lucoder.com/media/scripts/jquery.js"></script>
  <script src="https://www.lucoder.com/media/scripts/jquery-migrate-1.2.1.min.js"></script>
  <script src="https://www.lucoder.com/media/scripts/jquery.appear.js"></script>


 </body>
</html>